[**ä¸­æ–‡**](https://github.com/ymcui/LERT) | [**English**](https://github.com/ymcui/LERT/blob/main/README_EN.md)

<p align="center">
    <br>
    <img src="./pics/banner.png" width="400"/>
    <br>
</p>
<p align="center">
    <a href="https://github.com/ymcui/LERT/blob/main/LICENSE">
        <img alt="GitHub" src="https://img.shields.io/github/license/ymcui/LERT.svg?color=blue&style=flat-square">
    </a>
</p>



A short description will be added (TBA).

----

[ä¸­è‹±æ–‡PERT](https://github.com/ymcui/PERT) | [ä¸­æ–‡MacBERT](https://github.com/ymcui/MacBERT) | [ä¸­æ–‡ELECTRA](https://github.com/ymcui/Chinese-ELECTRA) | [ä¸­æ–‡XLNet](https://github.com/ymcui/Chinese-XLNet) | [ä¸­æ–‡BERT](https://github.com/ymcui/Chinese-BERT-wwm) |  [çŸ¥è¯†è’¸é¦å·¥å…·TextBrewer](https://github.com/airaria/TextBrewer) | [æ¨¡å‹è£å‰ªå·¥å…·TextPruner](https://github.com/airaria/TextPruner)

æŸ¥çœ‹æ›´å¤šå“ˆå·¥å¤§è®¯é£è”åˆå®éªŒå®¤ï¼ˆHFLï¼‰å‘å¸ƒçš„èµ„æºï¼šhttps://github.com/ymcui/HFL-Anthology

## æ–°é—»
2022/10/26 **æ¨¡å‹ä¸‹è½½é“¾æ¥ã€åŸºçº¿ç³»ç»Ÿæ•ˆæœå·²æ›´æ–°ï¼Œæ¬¢è¿æå‰ä¸‹è½½ä½¿ç”¨ã€‚å…¶ä½™ä¿¡æ¯å¾…è¡¥å……ã€‚**

2022/10/18 æ„Ÿè°¢å„ä½çš„å…³æ³¨ï¼Œæœ¬é¡¹ç›®åœ¨é€æ¸å®Œå–„ä¸­ã€‚**å†…å®¹ä¸å®Œæ•´ï¼Œç›¸å…³ä¿¡æ¯å¾…è¡¥å……å®Œå–„ã€‚**

## å†…å®¹å¯¼å¼•
| ç« èŠ‚                                  | æè¿°                                                         |
| ------------------------------------- | ------------------------------------------------------------ |
| [ç®€ä»‹](#ç®€ä»‹)                         | LERTé¢„è®­ç»ƒæ¨¡å‹çš„åŸºæœ¬åŸç†                                       |
| [æ¨¡å‹ä¸‹è½½](#æ¨¡å‹ä¸‹è½½)         | LERTé¢„è®­ç»ƒæ¨¡å‹çš„ä¸‹è½½åœ°å€                               |
| [å¿«é€ŸåŠ è½½](#å¿«é€ŸåŠ è½½)                 | å¦‚ä½•ä½¿ç”¨[ğŸ¤—Transformers](https://github.com/huggingface/transformers)å¿«é€ŸåŠ è½½æ¨¡å‹ |
| [åŸºçº¿ç³»ç»Ÿæ•ˆæœ](#åŸºçº¿ç³»ç»Ÿæ•ˆæœ) | ä¸­æ–‡NLUä»»åŠ¡ä¸Šçš„åŸºçº¿ç³»ç»Ÿæ•ˆæœ                             |
| [FAQ](#FAQ)                           | å¸¸è§é—®é¢˜ç­”ç–‘                                                 |
| [å¼•ç”¨](#å¼•ç”¨)                         | æœ¬é¡¹ç›®çš„æŠ€æœ¯æŠ¥å‘Š                                          |


## ç®€ä»‹
TBA

## æ¨¡å‹ä¸‹è½½

### TensorFlow 1.xç‰ˆæœ¬ï¼ˆåŸç‰ˆï¼‰

- è¿™é‡Œä¸»è¦æä¾›TensorFlow 1.15ç‰ˆæœ¬çš„æ¨¡å‹æƒé‡ã€‚å¦‚éœ€PyTorchæˆ–è€…TensorFlow 2ç‰ˆæœ¬çš„æ¨¡å‹ï¼Œè¯·çœ‹ä¸‹ä¸€å°èŠ‚ã€‚

- TensorFlowå¼€æºæ¨¡å‹åŒ…å«**å®Œæ•´æƒé‡**ï¼ŒåŒ…æ‹¬MLM-headã€linguistic-headsç­‰ã€‚

| æ¨¡å‹ç®€ç§°                           | å±‚æ•° | éšå±‚å¤§å° |          æ³¨æ„åŠ›å¤´          |         å‚æ•°é‡        | Googleä¸‹è½½ |                          ç™¾åº¦ç›˜ä¸‹è½½                          |
| :--------------------------------- | :--: | :---------------------: | :--------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
| **Chinese-LERT-large**        | 24 | 1024 |  16  |  ~325M  |   [[TensorFlow]](https://drive.google.com/file/d/1a_OBYy6-4akWsk-9ciT5FAmsiwVONpvh/view?usp=sharing)   | [[TensorFlow]](https://pan.baidu.com/s/1pxsS3almc90DPvMXH6BMYQ?pwd=s82t)<br/>ï¼ˆå¯†ç ï¼šs82tï¼‰ |
| **Chinese-LERT-base**         | 12 | 768 |  12  |  ~102M  |   [[TensorFlow]](https://drive.google.com/file/d/1SD0P5O9NCZTJ5qOzvJo7QGyAJapNM_YS/view?usp=sharing)   | [[TensorFlow]](https://pan.baidu.com/s/1_yb1jCDJ4s2P8OrF_5E_Tg?pwd=9jgi)<br/>ï¼ˆå¯†ç ï¼š9jgiï¼‰ |
| **Chinese-LERT-small** | 12 | 256 | 4 | ~15M |  [[TensorFlow]](https://drive.google.com/file/d/1CRyI58lhih5pDzajUbU6AFoFWFnJq9eA/view?usp=sharing)  | [[TensorFlow]](https://pan.baidu.com/s/1fBk3em8a5iCMwPLJEBq2pQ?pwd=4vuy)<br/>ï¼ˆå¯†ç ï¼š4vuyï¼‰ |

> *è®­ç»ƒè¯­æ–™ï¼šä¸­æ–‡ç»´åŸºç™¾ç§‘ï¼Œå…¶ä»–ç™¾ç§‘ã€æ–°é—»ã€é—®ç­”ç­‰æ•°æ®ï¼Œæ€»è¯æ•°è¾¾5.4Bï¼Œçº¦å ç”¨20Gç£ç›˜ç©ºé—´ï¼Œä¸MacBERTç›¸åŒã€‚  
>
> **å‚æ•°é‡ï¼šä»…ç»Ÿè®¡transformeréƒ¨åˆ†ï¼Œä¸åŒ…å«task headéƒ¨åˆ†çš„å‚æ•°é‡ã€‚

ä»¥TensorFlowç‰ˆ`Chinese-LERT-base`ä¸ºä¾‹ï¼Œä¸‹è½½å®Œæ¯•åå¯¹zipæ–‡ä»¶è¿›è¡Œè§£å‹å¾—åˆ°ï¼š

```
chinese_lert_base_L-12_H-768_A-12.zip
    |- lert_model.ckpt      # æ¨¡å‹æƒé‡
    |- lert_model.meta      # æ¨¡å‹metaä¿¡æ¯
    |- lert_model.index     # æ¨¡å‹indexä¿¡æ¯
    |- lert_config.json     # æ¨¡å‹å‚æ•°
    |- vocab.txt            # è¯è¡¨ï¼ˆä¸è°·æ­ŒåŸç‰ˆä¸€è‡´ï¼‰
```

### PyTorchä»¥åŠTensorFlow 2ç‰ˆæœ¬

- é€šè¿‡ğŸ¤—transformersæ¨¡å‹åº“å¯ä»¥ä¸‹è½½TensorFlow (v2)å’ŒPyTorchç‰ˆæœ¬æ¨¡å‹ã€‚
- PyTorchå¼€æºç‰ˆæœ¬åŒ…å«MLMéƒ¨åˆ†çš„æƒé‡ï¼Œä½†**ä¸åŒ…å«linguistic heads**ã€‚

ä¸‹è½½æ–¹æ³•ï¼šç‚¹å‡»ä»»æ„éœ€è¦ä¸‹è½½çš„æ¨¡å‹ â†’ é€‰æ‹©"Files and versions"é€‰é¡¹å¡ â†’ ä¸‹è½½å¯¹åº”çš„æ¨¡å‹æ–‡ä»¶ã€‚

| æ¨¡å‹ç®€ç§° | æ¨¡å‹æ–‡ä»¶å¤§å° | transformersæ¨¡å‹åº“åœ°å€ |
| :------- | :---------: |  :---------- |
| **Chinese-LERT-large** | 1.2G | https://huggingface.co/hfl/chinese-lert-large |
| **Chinese-LERT-base** | ~400M | https://huggingface.co/hfl/chinese-lert-base |
| **Chinese-LERT-small** | ~60M | https://huggingface.co/hfl/chinese-lert-small |

## å¿«é€ŸåŠ è½½
ç”±äºLERTä¸»ä½“éƒ¨åˆ†ä»ç„¶æ˜¯BERTç»“æ„ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨[transformersåº“](https://github.com/huggingface/transformers)è½»æ¾è°ƒç”¨LERTæ¨¡å‹ã€‚

**æ³¨æ„ï¼šæœ¬ç›®å½•ä¸­çš„æ‰€æœ‰æ¨¡å‹å‡ä½¿ç”¨BertTokenizerä»¥åŠBertModelåŠ è½½ã€‚**

```python
from transformers import BertTokenizer, BertModel
tokenizer = BertTokenizer.from_pretrained("MODEL_NAME")
model = BertModel.from_pretrained("MODEL_NAME")
```
å…¶ä¸­`MODEL_NAME`å¯¹åº”åˆ—è¡¨å¦‚ä¸‹ï¼š

| æ¨¡å‹å                 | MODEL_NAME                 |
| ---------------------- | -------------------------- |
| Chinese-LERT-large     | hfl/chinese-lert-large     |
| Chinese-LERT-base      | hfl/chinese-lert-base      |
| Chinese-LERT-small | hfl/chinese-lert-small |

## åŸºçº¿ç³»ç»Ÿæ•ˆæœ
è®ºæ–‡ä¸­åœ¨ä»¥ä¸‹10ä¸ªä»»åŠ¡ä¸Šè¿›è¡Œäº†æ•ˆæœæµ‹è¯•ã€‚GitHubç›®å½•ä¸­ä»…æ˜¾ç¤ºå…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œå®Œæ•´ç»“æœè¯·å‚è€ƒè®ºæ–‡ã€‚
- **æŠ½å–å¼é˜…è¯»ç†è§£**ï¼ˆ2ï¼‰ï¼š[CMRC 2018ï¼ˆç®€ä½“ä¸­æ–‡ï¼‰](https://github.com/ymcui/cmrc2018)ã€[DRCDï¼ˆç¹ä½“ä¸­æ–‡ï¼‰](https://github.com/DRCKnowledgeTeam/DRCD)
- **æ–‡æœ¬åˆ†ç±»**ï¼ˆ6ï¼‰ï¼š
  - **å•å¥**ï¼ˆ2ï¼‰ï¼š[ChnSentiCorp](https://github.com/pengming617/bert_classification)ã€[TNEWS](https://github.com/CLUEbenchmark/CLUE)
  - **å¥å¯¹**ï¼ˆ4ï¼‰ï¼š[XNLI](https://github.com/google-research/bert/blob/master/multilingual.md)ã€[LCQMC](http://icrc.hitsz.edu.cn/info/1037/1146.htm)ã€[BQ Corpus](http://icrc.hitsz.edu.cn/Article/show/175.html)ã€[OCNLI](https://github.com/CLUEbenchmark/OCNLI)
- **å‘½åå®ä½“è¯†åˆ«**ï¼ˆ2ï¼‰ï¼š[MSRA-NER]()ã€[People's Dailyï¼ˆäººæ°‘æ—¥æŠ¥ï¼‰]()

å®éªŒç»“æœè¡¨æ ¼ä¸­ï¼Œ

1. æ‹¬å·å¤–ä¸ºå¤šæ¬¡finetuneæœ€å¤§å€¼ï¼Œæ‹¬å·å†…ä¸ºå¹³å‡å€¼ã€‚
2. é™¤*BERT*ï¼ˆå³è°·æ­ŒåŸç‰ˆBERT-baseï¼‰æ¨¡å‹å¤–ï¼Œå…¶ä½™æ¨¡å‹å‡ä½¿ç”¨åŒç­‰æ•°æ®é‡è¿›è¡Œè®­ç»ƒã€‚

### é˜…è¯»ç†è§£ï¼ˆCMRC 2018ï¼‰

[**CMRC 2018æ•°æ®é›†**](https://github.com/ymcui/cmrc2018)æ˜¯å“ˆå·¥å¤§è®¯é£è”åˆå®éªŒå®¤å‘å¸ƒçš„ä¸­æ–‡æœºå™¨é˜…è¯»ç†è§£æ•°æ®ï¼ˆæŠ½å–å¼ï¼‰ï¼Œå½¢å¼ä¸SQuADç›¸åŒã€‚ï¼ˆè¯„ä»·æŒ‡æ ‡ï¼šEM / F1ï¼‰

| æ¨¡å‹ | å¼€å‘é›† | æµ‹è¯•é›† | æŒ‘æˆ˜é›† |
| :------- | :---------: | :---------: | :---------: |
| **â†“ ä»¥ä¸‹ä¸ºbaseæ¨¡å‹** ||||
| BERT | 65.5 (64.4) / 84.5 (84.0) | 70.0 (68.7) / 87.0 (86.3) | 18.6 (17.0) / 43.3 (41.3) |
| BERT-wwm-ext | 67.1 (65.6) / 85.7 (85.0) | 71.4 (70.0) / 87.7 (87.0) | 24.0 (20.0) / 47.3 (44.6) |
| RoBERTa-wwm-ext | 67.4 (66.5) / 87.2 (86.5) | 72.6 (71.4) / 89.4 (88.8) | 26.2 (24.6) / 51.0 (49.1) |
| MacBERT-base|68.5 (67.3) / 87.9 (87.1)|73.2 (72.4) / 89.5 (89.2)|**30.2** (26.4) / 54.0 (52.2)|
| PERT-base |68.5 (68.1) / 87.2 (87.1)|72.8 (72.5) / 89.2 (89.0)|28.7 (**28.2**) / 55.4 (53.7)|
| **LERT-base** |**69.2 (68.4) / 88.1 (87.9)**|**73.5 (72.8) / 89.7 (89.4)**|27.7 (26.7) / **55.9 (54.6)**|
| **â†“ ä»¥ä¸‹ä¸ºlargeæ¨¡å‹** ||||
| RoBERTa-wwm-ext-large | 68.5 (67.6) / 88.4 (87.9) | 74.2 (72.4) / 90.6 (90.0) | 31.5 (30.1) / 60.1 (57.5) |
| MacBERT-base|70.7 (68.6) / 88.9 (88.2)|74.8 (73.2) / 90.7 (90.1)|31.9 (29.6) / 60.2 (57.6)|
| PERT-base |**72.2 (71.0)** / 89.4 (88.8)|**76.8 (75.5)** / 90.7 (90.4)|**32.3 (30.9)** / 59.2 (58.1)|
| **LERT-base** |71.2 (70.5) / **89.5 (89.1)**|75.6 (75.1) / **90.9 (90.6)**|32.3 (29.7) / **61.2 (59.2)**|


### å•å¥æ–‡æœ¬åˆ†ç±»ï¼ˆChnSentiCorpã€TNEWSï¼‰

ä»¥ä¸‹ä¸ºæƒ…æ„Ÿåˆ†ç±»æ•°æ®é›†ChnSentiCorpå’Œæ–°é—»åˆ†ç±»æ•°æ®é›†TNEWSç»“æœã€‚ï¼ˆè¯„ä»·æŒ‡æ ‡ï¼šAccï¼‰
| æ¨¡å‹ | ChnSentiCorp-å¼€å‘é›† | TNEWS-å¼€å‘é›† |
| :------- | :---------: | :---------: |
| **â†“ ä»¥ä¸‹ä¸ºbaseæ¨¡å‹** |||
| BERT-wwm-ext | **95.4** (94.6) |57.0 (56.6)|
| RoBERTa-wwm-ext | 94.9 (94.6) |57.4 (56.9)|
| MacBERT-base|95.2 (**94.8**)|57.4 (**57.1**)|
| PERT-base |94.0 (93.7)|56.7 (56.1)|
| **LERT-base** |94.9 (94.7)|**57.5 (57.1)**|
| **â†“ ä»¥ä¸‹ä¸ºlargeæ¨¡å‹** |||
| RoBERTa-wwm-ext-large | **95.8** (94.9) |58.8 (58.4)|
| MacBERT-base|95.7 (**95.0**)|**59.0 (58.8)**|
| PERT-base |94.5 (94.0)|57.4 (57.2)|
| **LERT-base** |95.6 (94.9)|58.7 (58.5)|

### å¥å¯¹æ–‡æœ¬åˆ†ç±»ï¼ˆXNLIã€OCNLIï¼‰

ä»¥ä¸‹ä¸ºè‡ªç„¶è¯­è¨€æ¨æ–­XNLIå’ŒOCNLIæ•°æ®é›†ç»“æœã€‚ï¼ˆè¯„ä»·æŒ‡æ ‡ï¼šAccï¼‰

| æ¨¡å‹ | XNLI-å¼€å‘é›† | OCNLI-å¼€å‘é›† |
| :------- | :---------: | :---------: |
| **â†“ ä»¥ä¸‹ä¸ºbaseæ¨¡å‹** |||
| BERT-wwm-ext | 79.4 (78.6) |76.0 (75.3)|
| RoBERTa-wwm-ext | 80.0 (79.2) |76.5 (76.0)|
| MacBERT-base|**80.3 (79.7)**|77.0 (76.5)|
| PERT-base |78.8 (78.1)|75.3 (74.8)|
| **LERT-base** |80.2 (79.5)|**78.2 (77.5)**|
| **â†“ ä»¥ä¸‹ä¸ºlargeæ¨¡å‹** |||
| RoBERTa-wwm-ext-large | 82.1 (81.3) |78.5 (78.2)|
| MacBERT-base|**82.4 (81.8)**|79.0 (78.7)|
| PERT-base |81.0 (80.4)|78.1 (77.8)|
| **LERT-base** |81.7 (81.2)|**79.4 (78.9)**|

### å‘½åå®ä½“è¯†åˆ«ï¼ˆMSRAã€PDï¼‰

ä»¥ä¸‹ä¸ºMSRAï¼ˆæµ‹è¯•é›†ï¼‰å’Œäººæ°‘æ—¥æŠ¥æ•°æ®é›†ï¼ˆå¼€å‘é›†ï¼‰ç»“æœã€‚ï¼ˆè¯„ä»·æŒ‡æ ‡ï¼šFå€¼ï¼‰

| æ¨¡å‹ | MSRA-æµ‹è¯•é›† | PD-å¼€å‘é›† |
| :------- | :---------: | :---------: |
| **â†“ ä»¥ä¸‹ä¸ºbaseæ¨¡å‹** |||
| BERT-wwm-ext | 95.3 (94.9) |95.3 (95.1)|
| RoBERTa-wwm-ext | 95.5 (95.1) |95.1 (94.9)|
| MacBERT-base|95.3 (95.1)|95.2 (94.9)|
| PERT-base |95.6 (95.3)|95.3 (95.1)|
| **LERT-base** |**95.7 (95.4)**|**95.6 (95.4)**|
| **â†“ ä»¥ä¸‹ä¸ºlargeæ¨¡å‹** |||
| RoBERTa-wwm-ext-large | 95.5 (95.5) |95.7 (95.4)|
| MacBERT-base|96.2 (95.9)|95.8 (95.7)|
| PERT-base |96.2 (96.0)|96.1 (95.8)|
| **LERT-base** |**96.3 (96.0)**|**96.3 (96.0)**|


### å°æ¨¡å‹æ•ˆæœ
TBA

## FAQ
**Q1: ä¸ºä»€ä¹ˆPyTorchç‰ˆæœ¬ä¸åŒ…å«linguistic heads?**  
A1: PyTorchç‰ˆæœ¬æ¨¡å‹ç”±TFåŸç‰ˆè½¬æ¢è€Œæ¥ã€‚ä¸ºäº†å¯ä»¥ç›´æ¥ä½¿ç”¨bertç›¸å…³æ¥å£è¯»å–LERTæ¨¡å‹ï¼ŒPyTorchç‰ˆæœ¬ä¸­åªåŒ…å«äº†Transformer+MLMéƒ¨åˆ†çš„æƒé‡ã€‚å¦‚éœ€å®Œæ•´ç‰ˆæœ¬çš„æ¨¡å‹ï¼Œè¯·ä¸‹è½½TF 1.xç‰ˆæœ¬çš„æ¨¡å‹ã€‚å¦å¤–éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚éœ€ç›´æ¥åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸­ä½¿ç”¨æˆ–è€…äºŒæ¬¡é¢„è®­ç»ƒçš„è¯æ˜¯ä¸éœ€è¦linguistic headsè¿™éƒ¨åˆ†æƒé‡çš„ã€‚

**Q2:æœ‰è‹±æ–‡æ¨¡å‹ä¾›ä¸‹è½½å—ï¼Ÿ**  
A2: æš‚æ—¶æ— è®¡åˆ’åœ¨è‹±æ–‡ä¸Šè®­ç»ƒã€‚


## å¼•ç”¨
TBA


## å…³æ³¨æˆ‘ä»¬
æ¬¢è¿å…³æ³¨å“ˆå·¥å¤§è®¯é£è”åˆå®éªŒå®¤å®˜æ–¹å¾®ä¿¡å…¬ä¼—å·ï¼Œäº†è§£æœ€æ–°çš„æŠ€æœ¯åŠ¨æ€ã€‚

![qrcode.png](https://github.com/ymcui/cmrc2019/raw/master/qrcode.jpg)


## é—®é¢˜åé¦ˆ
å¦‚æœ‰é—®é¢˜ï¼Œè¯·åœ¨GitHub Issueä¸­æäº¤ã€‚

- åœ¨æäº¤é—®é¢˜ä¹‹å‰ï¼Œè¯·å…ˆæŸ¥çœ‹FAQèƒ½å¦è§£å†³é—®é¢˜ï¼ŒåŒæ—¶å»ºè®®æŸ¥é˜…ä»¥å¾€çš„issueæ˜¯å¦èƒ½è§£å†³ä½ çš„é—®é¢˜ã€‚
- é‡å¤ä»¥åŠä¸æœ¬é¡¹ç›®æ— å…³çš„issueä¼šè¢«[stable-bot](stale Â· GitHub Marketplace)å¤„ç†ï¼Œæ•¬è¯·è°…è§£ã€‚
- æˆ‘ä»¬ä¼šå°½å¯èƒ½çš„è§£ç­”ä½ çš„é—®é¢˜ï¼Œä½†æ— æ³•ä¿è¯ä½ çš„é—®é¢˜ä¸€å®šä¼šè¢«è§£ç­”ã€‚
- ç¤¼è²Œåœ°æå‡ºé—®é¢˜ï¼Œæ„å»ºå’Œè°çš„è®¨è®ºç¤¾åŒºã€‚
